import{u,_ as R,a as c}from"./axios-C6U-CQOT.js";import{u as q,f as N,e as U,c as j,a as n,j as o,w as r,F as T,n as D,r as l,o as K,g,i as M,t as Q,k as Y}from"./index-DyybID5S.js";import{u as z}from"./useQuery-YXMrn9Cc.js";const G={class:"d-flex justify-center"},H={style:{height:"50px"},class:"d-flex px-4 py-2 flex-wrap align-center bg-grey-lighten-4"},te={__name:"index",setup(J){const f=[{title:"شناسه",key:"id"},{title:"نام",key:"name"},{title:"عملیات",key:"actions",align:"center",sortable:!1}],i=q(),{data:v,refetch:m,isPending:h}=z({queryKey:["weights"],queryFn:()=>c.get("weights")}),{mutate:y,isPending:x}=u({mutationFn:t=>c.post("weights",t),onSuccess:()=>{i.openAlert(0,"با موفقیت افزوده شد"),m(),s.close()},onError:t=>{console.log(t);const{data:e}=t.response;e.message?i.openAlert(2,e.message):i.openAlert(2,"عملیات با خطا مواجه شد")}}),{mutate:w,isPending:b}=u({mutationFn:(t,e)=>c.patch(`weights/${t}`,e),onSuccess:()=>{i.openAlert(0,"با موفقیت ویرایش شد"),m(),s.close()},onError:t=>{console.log(t);const{data:e}=t.response;e.message?i.openAlert(2,e.message):i.openAlert(2,"عملیات با خطا مواجه شد")}}),{mutate:k,isPending:V}=u({mutationFn:t=>c.delete(`weights/${t}`),onSuccess:()=>{i.openAlert(0,"حذف با موفقیت انجام شد"),m()},onError:t=>{console.log(t);const{data:e}=t.response;e.message?i.openAlert(2,e.message):i.openAlert(2,"عملیات با خطا مواجه شد")}}),p=N(0),s=U({canBeShown:!1,item:null,formRef:null,submitLoading:!1,form:{name:""},async open(t){var e;this.canBeShown=!0,this.item=null,await D(),(e=this.formRef)==null||e.reset(),t&&(this.item=t,this.form.name=t.name)},close(){this.canBeShown=!1},add(){const t={name:this.form.name};y(t)},async update(){const t={name:this.form.name};w(this.item.id,t)}});async function S(t){const{isConfirmed:e}=await Y();e&&(p.value=t.id,k(t.id))}return(t,e)=>{const d=l("v-btn"),A=l("v-data-table"),B=l("v-card-title"),_=l("v-divider"),C=l("v-text-field"),$=l("v-col"),F=l("v-row"),W=l("v-card-text"),L=l("v-spacer"),E=R,I=l("v-card"),P=l("v-dialog");return K(),j(T,null,[n(d,{class:"mb-3",text:"افزودن بسته‌بندی",color:"primary",onClick:e[0]||(e[0]=a=>o(s).open())}),n(A,{class:"border",headers:f,items:o(v),"items-per-page":10,loading:o(h)},{"item.actions":r(({item:a})=>[g("div",G,[n(d,{class:"mx-1",text:"حذف",color:"error",loading:o(V)&&o(p)==a.id,onClick:O=>S(a)},null,8,["loading","onClick"])])]),_:1},8,["items","loading"]),n(P,{"max-width":"500",modelValue:o(s).canBeShown,"onUpdate:modelValue":e[5]||(e[5]=a=>o(s).canBeShown=a)},{default:r(()=>[n(I,null,{default:r(()=>[n(E,{modelValue:o(s).formRef,"onUpdate:modelValue":e[3]||(e[3]=a=>o(s).formRef=a),onValid:e[4]||(e[4]=a=>o(s).item?o(s).update():o(s).add())},{default:r(()=>[n(B,{style:{height:"50px"},class:"bg-grey-lighten-3"},{default:r(()=>[M(Q(o(s).item?"ویرایش بسته‌بندی":"افزودن بسته‌بندی"),1)]),_:1}),n(_,{class:"border-opacity-25",color:"black"}),n(W,null,{default:r(()=>[n(F,null,{default:r(()=>[n($,{cols:"12"},{default:r(()=>[n(C,{modelValue:o(s).form.name,"onUpdate:modelValue":e[1]||(e[1]=a=>o(s).form.name=a),label:"نام بسته‌بندی",variant:"outlined",rules:[t.required]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),n(_,{class:"border-opacity-25",color:"black"}),g("div",H,[n(L),n(d,{class:"ml-2",type:"submit","min-width":"100",color:"primary",text:o(s).item?"ویرایش":"افزودن",loading:o(x)||o(b)},null,8,["text","loading"]),n(d,{"min-width":"100",color:"error",text:"لغو",onClick:e[2]||(e[2]=a=>o(s).close())})])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])],64)}}};export{te as default};
